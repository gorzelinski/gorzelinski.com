---
title: Jezu Chryste, to Bourneâ€¦ Again Shell Scripting
description: 'PrzestaÅ„ baÄ‡ siÄ™ skryptÃ³w Basha! Poznaj podstawowÄ… skÅ‚adniÄ™ â€” rozwiniÄ™cia, zmienne, testy, pÄ™tle i funkcje â€” oraz pracÄ™ z argumentami, opcjami i danymi wejÅ›ciowymi.'
date: 2026-01-05T17:00:00+02:00
updated: 2026-01-05T17:00:00+02:00
image:
  alt: 'Prompt Basha z komendÄ… sudo'
  caption: 'ZdjÄ™cie autorstwa Gabriel Heinzer'
  src: 'gabriel-heinzer-4Mw7nkQDByk-unsplash.jpg'
categories: ['informatyka']
tags: ['terminal', 'bash', 'powÅ‚oka', 'cli', 'skrypty']
type: 'post'
---

Bash jest popularnÄ… powÅ‚okÄ… dostÄ™pnÄ… na systemach operacyjnych takich jak macOS czy Linux. MoÅ¼esz uzyskaÄ‡ do niej dostÄ™p przez terminal i wpisywaÄ‡ w niej komendy. Czym jest powÅ‚oka? Czym jest terminal? Czym jest komenda? JeÅ¼eli chcesz siÄ™ zapoznaÄ‡ z tymi terminami, sprawdÅº [pierwszÄ… czÄ™Å›Ä‡](/pl/blog/jesus-christ-thats-bourne-again-shell/) tej krÃ³tkiej serii o powÅ‚oce Bash. W tym wpisie skupimy siÄ™ na podstawowej skÅ‚adni, aby tworzyÄ‡ nasze pierwsze skrypty powÅ‚oki.

## Wbudowane (i inne) komendy Basha

JednakÅ¼e, zanim napiszemy jakikolwiek skrypt, musimy zrozumieÄ‡ jak Bash je wykonuje. MoÅ¼emy uruchamiaÄ‡ rÃ³Å¼ne programy przez terminal. Komenda taka jak `code path/to/codebase` powinna byÄ‡ ci znajoma, jeÅ¼eli uÅ¼ywasz Visual Studio Code. MoÅ¼liwe, Å¼e wpisujesz `cd` wielokrotnie w ciÄ…gu dnia, aby zmieniaÄ‡ katalogi. Albo `echo`, Å¼eby wyÅ›wietlaÄ‡ rzeczy na ekranie. Trzeba tu poczyniÄ‡ istotne rozrÃ³Å¼nienie pomiÄ™dzy tymi komendami. NiektÃ³re z nich sÄ… wbudowane w Basha, podczas gdy inne nie sÄ….

- **Wbudowane komendy** sÄ… bezpoÅ›rednio wykonywane przez powÅ‚okÄ™.
- Bash interpretuje **inne komendy** jako zapytanie do zaÅ‚adowania i uruchomienia innego programu.

Komenda `cd` musi byÄ‡ wbudowana, poniewaÅ¼ operuje na bieÅ¼Ä…cym katalogu powÅ‚oki. Komenda `code` otwiera zewnÄ™trzny program - Visual Studio Code. SÄ… nawet komendy, ktÃ³re mogÄ… byÄ‡ oboma typami jak `echo`. Z powodu wydajnoÅ›ci jest wbudowana, ale nie musi byÄ‡. MoÅ¼emy to sprawdziÄ‡. Aby zobaczyÄ‡, ktÃ³rej wersji uÅ¼ywasz, moÅ¼esz wpisaÄ‡:

```bash
command -V echo
```

Powinna pojawiÄ‡ siÄ™ informacja, Å¼e `echo` jest wbudowanÄ… komendÄ…. PowÅ‚oka domyÅ›lnie uruchamia wbudowane komendy. PÃ³Åºniej szuka innych programÃ³w. Te programy sÄ… zlokalizowane w katalogu `/usr/bin/`.

To rozrÃ³Å¼nienie jest istotne jeszcze z innego powodu. Oba typy komend uÅ¼ywajÄ… rÃ³Å¼nych systemÃ³w dokumentacji. Aby dowiedzieÄ‡ siÄ™ wiÄ™cej o wbudowanej komendzie wpisz:

```bash
help echo
```

## Rozwijanie i podstawianie w Bashu

Rozwijanie i podstawienie pozwala nam okreÅ›liÄ‡ wartoÅ›ci, ktÃ³re nie sÄ… znane do momentu uruchomienia skryptu. Poznamy rÃ³Å¼ne typy rozszerzeÅ„ i podstawieÅ„ w kolejnych sekcjach.

<Callout variant="info">

Wiele jÄ™zykÃ³w programowania uÅ¼ywa nawiasÃ³w do grupowania blokÃ³w kodu (_Python: Am I a joke to you?_). Bash uÅ¼ywa ich inaczej. Nawiasy w Bashu sÄ… czÄ™sto komendami.

</Callout>

### Rozwijanie tyldy

**Rozwijanie tyldy** reprezentuje zmiennÄ… Å›rodowiskowÄ… uÅ¼ytkownika - `$HOME`. W zwiÄ…zku z tym, katalog `~/Documents` zostanie rozszerzony do czegoÅ› takiego jak `/home/jan/Documents`.

### Rozwijanie nawiasÃ³w

**Rozwijanie nawiasÃ³w** tworzy zbiory lub zakresy.

```bash
{a,b,c} # ZbiÃ³r
{x..y..i} # Zakres
```

Ta skÅ‚adnia pozwala nam zastÄ…piÄ‡ elementy wartoÅ›ciami z listy.

- **ZbiÃ³r** to lista wartoÅ›ci oddzielona przecinkami.
- **Zakres** to lista liter bÄ…dÅº liczb pomiÄ™dzy dwoma wartoÅ›ciami. Istnieje teÅ¼ opcja, aby zadeklarowaÄ‡ krok.

Jak moÅ¼emy to wykorzystaÄ‡? Powiedzmy, Å¼e chcemy stworzyÄ‡ kilka plikÃ³w - szkielet komponentu Angular. Potrzebujemy przynajmniej trzech, rÃ³Å¼nych plikÃ³w:

1. Pliku komponentu: `<component-name>.component.ts`
2. Szablonu: `<component-name>.component.html`
3. Pliku CSS: `<component-name>.component.css`

Zamiast klikaÄ‡ i manualnie tworzyÄ‡ wszystkie te pliki, moÅ¼emy napisaÄ‡ jednÄ… komendÄ™ Basha.

```bash
touch example.component.{ts,html,css}
```

"W zasadzie, moÅ¼esz skorzystaÄ‡ z Angular CLI do tworzenia komponentÃ³w ğŸ¤“". Wiem, ale chciaÅ‚em daÄ‡ jakiÅ› sensowny przykÅ‚ad. Jest prosty, ale pewnie widzisz juÅ¼ potencjaÅ‚ jak potÄ™Å¼ne potrafi to byÄ‡. SzczegÃ³lnie w poÅ‚Ä…czeniu z zakresami.

```bash
echo {0..100..2}
```

PrzykÅ‚ad powyÅ¼ej wypisuje liczby od 0 do 100 z krokiem 2. Ponownie, jest to proste, ale nie musi byÄ‡. MoÅ¼esz uÅ¼yÄ‡ tej skÅ‚adni wewnÄ…trz skryptÃ³w, komend, katalogÃ³w, itp., aby tworzyÄ‡ caÅ‚e struktury plikÃ³w prostymi jednolinijkowcami!

### Rozwijanie parametrÃ³w

**Rozwijanie parametrÃ³w** pobiera i transformuje przechowywane wartoÅ›ci.

```bash
${...}
```

Zasadniczo, wykorzystujemy je do operowania zmiennymi. Najpierw ustawiamy parametr rÃ³wny jakiejÅ› wartoÅ›ci. PÃ³Åºniej uÅ¼ywamy znaku dolara (i opcjonalnie nawiasÃ³w klamrowych) z nazwÄ… parametru, aby pobraÄ‡ wartoÅ›Ä‡.

```bash
a="Amelie"
echo $a # Amelie
echo ${a} # Amelie
```

MoÅ¼esz takÅ¼e wykorzystaÄ‡ skÅ‚adniÄ™ klamrowÄ…, aby wyciÄ…gnÄ…Ä‡ lub manipulowaÄ‡ wartoÅ›ciÄ… parametru.

```bash
echo ${a:3:6} # lie
echo ${a/Amelie/Bridget} # Bridget
```

SkÅ‚adnia ta przypomina operator wycinania w jÄ™zyku Python.

### Rozwijanie arytmetyczne

**Rozwijanie matematyczne** sÅ‚uÅ¼y do wykonywania obliczeÅ„. Tak po prostu.

```bash
$((...))
```

Aby kalkulowaÄ‡ jakieÅ› liczby, umieÅ›Ä‡ je wewnÄ…trz podwÃ³jnych, okrÄ…gÅ‚ych nawiasÃ³w. MoÅ¼esz wykonywaÄ‡ podstawowe operacje matematyczne znane z innych jÄ™zykÃ³w programowania, jak dodawanie, odejmowanie, mnoÅ¼enie, dzielenie lub modulo.

```bash
echo $(( 2 + 2 )) # 4
```

<Callout variant="warning">

Bash wspiera obliczenia tylko na liczbach caÅ‚kowitych.

</Callout>

### Podstawianie komend

Po usuniÄ™ciu jednej pary nawiasÃ³w, otrzymujemy podstawianie komend. **Podstawianie komend** umieszcza wyjÅ›cie jednej komendy wewnÄ…trz innej.

```bash
$(...)
```

MoÅ¼esz myÅ›leÄ‡ o tym jak o interpolacji Å‚aÅ„cuchÃ³w znakÃ³w. Bash wykonuje komendÄ™ w podpowÅ‚oce i zwraca wyjÅ›cie do bieÅ¼Ä…cej komendy. MoÅ¼emy na przykÅ‚ad uÅ¼yÄ‡ jednej komendy do wyodrÄ™bnienia informacji o architekturze procesora i uÅ¼yÄ‡ komendy `echo`, aby je wyÅ›wietliÄ‡.

```bash
echo "Architektura twojego procesora to $(uname -m)."
# Architektura twojego procesora to arm64.
```

MoÅ¼esz nawet poÅ‚Ä…czyÄ‡ wyjÅ›cie z innego jÄ™zyka programowania, jak Python.

```bash
echo "Colonel Campbell: $(python3 -c 'print("Snaaake!")' | tr [a-z] [A-Z])"
# Colonel Campbell: SNAAAKE!
```

Tylko wyobraÅº sobie moÅ¼liwoÅ›ci, gdy sparujemy to z manipulacjÄ… Å‚aÅ„cuchami, potokami i rozwijaniem, ktÃ³re omÃ³wiliÅ›my!

## SkÅ‚adnia skryptÃ³w Basha

W tym i poprzednim wpisie, uruchamialiÅ›my gÅ‚Ã³wnie pojedyncze komendy. Dla prostych przypadkÃ³w sÄ… wystarczajÄ…ce, ale zaczynajÄ… byÄ‡ niewygodne w zÅ‚oÅ¼onych skryptach. Mamy kilka innych opcji, aby uruchamiaÄ‡ wiele komend.

### Jednolinijkowce

Do tej pory ich uÅ¼ywaliÅ›my. SÄ… to komendy zapisane w jednej lini tekstu, czÄ™sto oddzielone Å›rednikami lub zÅ‚oÅ¼one w potok (jak w przykÅ‚adzie powyÅ¼ej). Miej na uwadze, Å¼e "jedna linia" nie oznacza dosÅ‚ownie pojedynczej, horyzontalnej lini w terminalu. Linie mogÄ… byÄ‡ bardzo dÅ‚ugie i zawijaÄ‡ siÄ™ wewnÄ…trz terminala.

### Skrypty Basha

DÅ‚uga linia tekstu nie jest zbyt czytelna. W zÅ‚oÅ¼onych przypadkach, lepiej uÅ¼yÄ‡ skryptu. Jest to plik, ktÃ³ry zawiera seriÄ™ komend. MoÅ¼e takÅ¼e zawieraÄ‡ pÄ™tle, logikÄ™ warunkowÄ… i skÅ‚adniÄ™ znanÄ… z innych jÄ™zykÃ³w programowania (pomÃ³wimy o niej pÃ³Åºniej). Pliki te uÅ¼ywajÄ… rozszerzenia `.sh`. Taki skrypt moÅ¼esz wywoÅ‚aÄ‡ bezpoÅ›rednio uÅ¼ywajÄ…c basha, np.: `bash myscript.sh`.

```bash
# myscript.sh - SprawdÅº uÅ¼ycie dysku i wyÅ›lij alert

THRESHOLD=80
USAGE=$(df -h / | awk 'NR==2 {print $5}' | sed 's/%//')

if [ "$USAGE" -gt "$THRESHOLD" ]; then
    echo "Uwaga: ZapeÅ‚nienie dysku na poziomie ${USAGE}%"
    echo "Krytyczna iloÅ›Ä‡ miejsca: $(hostname)" | mail -s "Alert dysku" admin@example.com
else
    echo "ZapeÅ‚nienie dysku jest w normie: ${USAGE}%"
fi
```

### Wykonywalne skrypty Basha

Stworzenie wykonywalnego skryptu, wymaga umieszczenia znaku "shebang" w pierwszej linii (wymawia siÄ™ to "shuhÂ·bang", a nie "she bangs", pomimo, Å¼e [Ricky Martin](https://youtu.be/5ihtX86JzmA?si=V7MJAev-1EuDw6uT) preferowaÅ‚by drugÄ… wersjÄ™). Linia ta informuje system operacyjny, ktÃ³rego interpretera powinien uÅ¼yÄ‡ do wykonania pliku. Jak poprzednie zdanie sugeruje, nie musi to byÄ‡ Bash. Takie pliki nie wymagajÄ… rozszerzenia, ale wymagajÄ… odpowiednich uprawnieÅ„. MoÅ¼esz przerobiÄ‡ skrypt na wykonywalny wykorzystujÄ…c `chmod +x myscript`. Po tej operacji moÅ¼esz uruchomiÄ‡ ten plik bezpoÅ›rednio, wpisujÄ…c `./myscript` (lub `myscript` jeÅ¼eli jest w zmiennej `$PATH`).

```bash
# Uruchom plik wykorzystujÄ…c Bash
#!/bin/bash

# Uruchom plik wykorzystujÄ…c PHP
#!/usr/bin/php

# Uruchom plik wykorzystujÄ…c Pythona
#!/usr/bin/python

# Skrypt w odpowiednim jÄ™zyku programowania
```

<Callout variant="info">

Aby dowiedzieÄ‡ siÄ™ wiÄ™cej o zmiennej `$PATH` lub standardowym wyjÅ›ciu, sprawdÅº mÃ³j [poprzedni post](/pl/blog/jesus-christ-thats-bourne-again-shell/).

</Callout>

## Komenda echo

Jak wspomniaÅ‚em wczeÅ›niej, komenda `echo` wyÅ›wietla informacje na ekranie, lub bardziej precyzyjnie, w standardowym wyjÅ›ciu. JednakÅ¼e, moÅ¼e byÄ‡ przekierowana gdziekolwiek. MoÅ¼e zwracaÄ‡ statyczny tekst, zmienne, lub dowolnÄ…, innÄ… wartoÅ›Ä‡. MoÅ¼esz na przykÅ‚ad stworzyÄ‡ pusty plik bez korzystania z komendy `touch`.

```bash
echo -n > nazwa-pliku.txt
```

## CudzysÅ‚owy w Bashu

W tym miejscu mogÄ™ zrobiÄ‡ dobry segue do znakÃ³w cudzysÅ‚owu w Bashu. Przyzwyczajenia z jÄ™zyka JavaScript, mogÄ… wpÄ™dziÄ‡ nas w puÅ‚apkÄ™ zamiennego uÅ¼ywania pojedynczych i podwÃ³jnych cudzysÅ‚owÃ³w. W Bashu, istniejÄ… pomiÄ™dzy nimi rÃ³Å¼nice.

- **Pojedyncze cudzysÅ‚owy** (lub silne cudzysÅ‚owy) oznaczajÄ…, Å¼e wszystko wewnÄ…trz powinno byÄ‡ traktowane jak tekst.
- W **podwÃ³jnych cudzysÅ‚owach** Bash bÄ™dzie interpretowaÅ‚ rozwijanie, podstawianie, obliczenia, zmienne, itd.

JednakÅ¼e, ignorowanie specjalnych znakÃ³w wymaga poprzedzenia ich znakiem odwrotnego ukoÅ›nika.

## Zmienne w Bashu

Zmienne w Bashu wymagajÄ… szerszego omÃ³wienia. Nie bÄ™dzie zaskoczeniem, Å¼e zmienne w Bashu pozwalajÄ… nam zapisywaÄ‡ i pobieraÄ‡ wartoÅ›ci poprzez nazwy, jak w innych jÄ™zykach programowania. SÄ… one specjalnym przypadkiem podstawiania parametrÃ³w.

<Callout variant="warning">

Zmienne w Bashu powinny byÄ‡ zapisane alfanumerycznymi znakami i uwzglÄ™dniajÄ… wielkoÅ›Ä‡ liter.

</Callout>

Na naszych systemach istniejÄ… zmienne Å›rodowiskowe, takie jak `$PATH`. Nasze zmienne powinniÅ›my zapisywaÄ‡ z maÅ‚ej litery, Å¼eby je rozrÃ³Å¼niÄ‡. Jest to dobra praktyka.

Ale jak zadeklarowaÄ‡ staÅ‚e uÅ¼ywajÄ…c maÅ‚ych liter? WykorzystujÄ…c specjalnÄ… flagÄ™.

```bash
declare -r readonlyvariable="sam"
```

Istnieje wiele flag do odkrycia. Na przykÅ‚ad, moÅ¼esz zmieniÄ‡ wielkoÅ›Ä‡ liter wartoÅ›ci samej zmiennej.

```bash
declare -l lowerstring="To jest TEKST!" # to jest tekst!
declare -u upperstring="To jest TEKST!" # TO JEST TEKST!
```

Å»eby sprawdziÄ‡ wszystkie zmienne w danej sesji, wpisz:

```bash
declare -p
```

## Liczby w Bashu

W poprzedniej sekcji, wspomniaÅ‚em o rozwijaniu arytmetycznym do wykonywania kalkulacji. Dodatkowo mamy arytmetycznÄ… ewaluacjÄ™ do naszej dyspozycji. RÃ³Å¼nica pomiÄ™dzy nimi leÅ¼y w nadpisywaniu zmiennych.

- **Rozwijanie arytmetyczne** (ze znakiem dolara) zwraca wynik matematycznych operacji bez zmieniania wartoÅ›ci zmiennej.
- **Ewaluacja arytmetyczna** (bez znaku dolara) dokonuje kalkulacji i zmienia wartoÅ›ci zmiennych.

```bash
a=3
((a++))
echo $a # 4
```

Bash wspiera szeÅ›Ä‡ podstawowych matematycznych operacji:

| Operacja    | Operator |
| ----------- | -------- |
| Dodawanie   | +        |
| Odejmowanie | -        |
| MnoÅ¼enie    | \*       |
| Dzielenie   | /        |
| Modulo      | %        |
| PotÄ™gowanie | \*\*     |

MoÅ¼esz takÅ¼e jasno zadeklarowaÄ‡ liczby caÅ‚kowite, wykorzystujÄ…c sÅ‚owo kluczowe `declare` wraz z odpowiedniÄ… flagÄ….

```bash
declare -i b=3
```

## Testy w Bashu

**Test** w Bashu to komenda, ktÃ³ra ocenia warunek i zwraca **status wyjÅ›cia.** Kwadratowe nawiasy owijajÄ… warunek. MoÅ¼esz testowaÄ‡ rÃ³Å¼ne rzeczy, jak uprawnienia, Å‚aÅ„cuchy znakÃ³w, liczby i wiele wiÄ™cej. Aby przetestowaÄ‡ czy istnieje katalog domowy, moÅ¼emy wpisaÄ‡:

```bash
[ -d ~ ]
```

## Status wyjÅ›cia

PowyÅ¼szy test zwraca status wyjÅ›cia `0`, jeÅ¼eli katalog istnieje. **Status wyjÅ›cia (lub kod wyjÅ›cia)** to maÅ‚a liczba caÅ‚kowita, zwracana do systemu operacyjnego, kiedy program koÅ„czy pracÄ™. W przeciwieÅ„stwie do innych jÄ™zykÃ³w programowania, Bash traktuje `0` jako sukces. MoÅ¼e on teÅ¼ byÄ‡ traktowany jak wartoÅ›Ä‡ logiczna w kodzie warunkowym:

- `0` rÃ³wna siÄ™ `true` (tak, Å¼eby wszystkich zdezorientowaÄ‡).
- `1` lub inna wartoÅ›Ä‡ powyÅ¼ej zera rÃ³wna siÄ™ `false`. RÃ³Å¼ne cyfry czÄ™sto oznaczajÄ… przyczyny awarii.

Zmienna `$?` przechowuje status ostatnio uruchamianej komendy.

```bash
[ "Amelie" = "Bridget" ]; echo $? # 1
```

W tym przypadku, zwraca `1`, bo Å‚aÅ„cuchy znakÃ³w nie sÄ… rÃ³wne. Poza Å‚aÅ„cuchami, moÅ¼emy takÅ¼e testowaÄ‡ inne rzeczy, jak wspomniaÅ‚em wczeÅ›niej. NajczÄ™stszymi typami testÃ³w sÄ…:

- ÅaÅ„cuchy znakÃ³w: pusty/niepusty, rÃ³wnoÅ›Ä‡, wyszukiwanie wzorcÃ³w.
- Liczby: `-eq`, `-ne`, `-lt,` `-le`, `-gt`, `-ge` (rÃ³wna, nierÃ³wna, mniejsza niÅ¼, itd.)
- Pliki: istnienie/typ/uprawnienia (`-e`, `-f`, `-d`, `-r`, `-w`, `-x`, `-s`).
- Logika: AND/OR/NOT (`-a`, `-o`, `!`, `&&`, `||`).

<Callout variant="info">

SkÅ‚adnia testÃ³w jest szeroko kompatybilna z rÃ³Å¼nymi powÅ‚okami. JednakÅ¼e, mogÄ… istnieÄ‡ rÃ³Å¼nice. `test` jest synonimem kwadratowych nawiasÃ³w. PodwÃ³jne kwadratowe nawiasy sÄ… bezpieczniejszym ekwiwalentem dostÄ™pnym w powÅ‚okach Bash/Ksh.

</Callout>

## Tablice w Bashu

Masz juÅ¼ doÅ›Ä‡ nawiasÃ³w? Bo nauczymy siÄ™ kolejnego konceptu, ktÃ³ry je wykorzystuje. **Tablica** w Bashu przechowuje wiele wartoÅ›ci. Nowsze wersje Basha wspierajÄ… dwa typy tablic:

- **TablicÄ™ indeksowanÄ…**
- **TablicÄ™ asocjacyjnÄ…**

W indeksowanej tablicy ustawiamy i odczytujemy informacje za pomocÄ… pozycji w liÅ›cie, czyli indeksu. Aby zadeklarowaÄ‡ takÄ… tablicÄ™, uÅ¼yj okrÄ…gÅ‚ych nawiasÃ³w:

```bash
beach=("Sam","Bridget")
declare -a beach=("Sam","Bridget") # WyraÅºna skÅ‚adnia
echo ${beach[0]} # Sam
beach+=("Amelie") # Dodaj wartoÅ›Ä‡
echo ${beach[@]} # WyÅ›wietl wszystkie wartoÅ›ci
```

JeÅ¼eli uÅ¼ywasz Basha w wersji 4 lub wyÅ¼szej, moÅ¼esz takÅ¼e deklarowaÄ‡ tablice asocjacyjne. WykorzystujÄ… one pary klucz/wartoÅ›Ä‡ podobne do obiektÃ³w JavaScript lub sÅ‚ownikÃ³w w jÄ™zyku Python.

```bash
declare -A beach
beach[name]="Sam"
```

JednakÅ¼e, oba typy sÄ… ograniczone do jednego poziomu. **Nie moÅ¼esz tworzyÄ‡ zagnieÅ¼dÅ¼onych tablic.**

## Struktury kontrolne w Bashu

W Bashu, moÅ¼esz kontrolowaÄ‡ wykonywanie programy wykorzystujÄ…c struktury kontrolne, takie jak rozgaÅ‚Ä™zienia, pÄ™tle, wybÃ³r przypadkÃ³w i kontrolowanie grup komend.

### Instrukcje warunkowe w Bashu

Bash wybiera, ktÃ³re komendy uruchomiÄ‡ bazujÄ…c na statusach wyjÅ›cia. Pozwala to kontrolowaÄ‡ przebieg wykonywania skryptu. MoÅ¼emy uruchamiaÄ‡ komendy bazujÄ…c na konkretnych warunkach. Istnieje wiele rÃ³Å¼nych skÅ‚adni instrukcji warunkowych `if`:

```bash
#1
if # warunek
then
	# skrypt
fi

#2
if # warunek
then
	# skrypt
else
	# skrypt
fi

#3
if [[...]]
then
	# skrypt
else
	# skrypt
fi

#4
if ((...))
then
	# skrypt
elif ((...))
then
	# skrypt
else
	# skrypt
fi

#5
if # warunek; then
	# skrypt
fi

#6
if # warunek; then # skrypt; fi
```

### PÄ™tle w Bashu

Bash oferuje dobrze znane typy pÄ™tli: `while`, `until` i `for`.

PÄ™tla `while` dziaÅ‚a dopÃ³ki warunek jest `true`.

```bash
while # ...
do
	# ...
done
```

PÄ™tla `until` dziaÅ‚a dopÃ³ki warunek jest `false`.

```bash
until # ...
do
	# ...
done
```

PÄ™tla `for` iteruje po liÅ›cie elementÃ³w, uruchamiajÄ…c kod dla kaÅ¼dego z nich. Tu takÅ¼e istniejÄ… alternatywne skÅ‚adnie.

```bash
#1
for i in # ...
do
	# ...
done

#2
for (( i=1; i<=10; i++ ))
do
	echo $i
done

#3
for i in * # List of files in the current directory
do
	echo "Found a file: $1"
done
```

### WyraÅ¼enie "case"

SkÅ‚adnia `case` jest rozgaÅ‚Ä™ziajÄ…cÄ… siÄ™ strukturÄ… kontrolnÄ…, ktÃ³ra dopasowuje wartoÅ›Ä‡ do wzorca, a nastÄ™pnie uruchamia pierwszÄ… pasujÄ…cÄ… opcjÄ™. Sprawdza zgodnoÅ›Ä‡ danych wejÅ›ciowych ze zbiorem zdefiniowanych wczeÅ›niej wartoÅ›ci. Jest zwykle bardziej przejrzysta i bezpieczniejsza niÅ¼ dÅ‚ugi ciÄ…g wyraÅ¼eÅ„ `if`/`elif` dla argumentÃ³w CLI.

```bash
person="sam"

case $person in
	sam) echo "Son";; # Konkretny przypadek
	amelie|bridget) echo "Mother";; # MoÅ¼esz uÅ¼ywaÄ‡ OR we wzorcach
	*) echo "Human";; # Dowolny przypadek
esac
```

## Funkcje w Bashu

Poza strukturami kontrolnymi, moÅ¼esz takÅ¼e uÅ¼ywaÄ‡ funkcji do organizowania swoich skryptÃ³w Basha. PozwalajÄ… one grupowaÄ‡ bloki kodu, a nastÄ™pnie wywoÅ‚ywaÄ‡ je jak komendy.

```bash
greet() {
	echo "Hi there, $1!"
}

greet "Snake" # Hi there, Snake!
```

<Callout variant="info">

Istnieje takÅ¼e alternatywna skÅ‚adnia do definiowania funkcji: `function fname {...}`.

</Callout>

Funkcja dostarcza argumenty dostÄ™pne w jej wnÄ™trzu:

- `$1`, `$2` - konkretne argumenty funkcji.
- `$@` - lista wszystkich argumentÃ³w.
- `$#` - liczba argumentÃ³w.
- `$FUNCNAME` - nazwa funkcji.

MoÅ¼esz takÅ¼e deklarowaÄ‡ wÅ‚asne zmienne wewnÄ…trz funkcji.

```bash
x="global"

f() {
	echo "$x"        # Funkcja odczytuje zmienne globalne
	x="changed"      # Modyfikuje zmiennÄ… globalnÄ…
	local y="temp"   # y istnieje tylko podczas f
}
```

Funkcja w Bashu moÅ¼e odczytywaÄ‡ zmienne globalne ze Å›rodowiska skryptu. Dodatkowo, zmienne zadeklarowane wewnÄ…trz funkcji sÄ… **w domyÅ›le globalne.** Aby wyrÃ³Å¼niÄ‡ zmienne lokalne, musisz deklarowaÄ‡ je wykorzystujÄ…c sÅ‚owo kluczowe `local`.

## Praca z argumentami Basha

Podobnie jak w funkcjach, moÅ¼emy dostarczaÄ‡ argumenty do caÅ‚ych skryptÃ³w Basha. **Argumenty** sÄ… specjalnym typem zmiennej ustawianej przez uÅ¼ytkownika, kiedy Bash wykonuje skrypt. Argumenty zwykle zawierajÄ… wartoÅ›ci na ktÃ³rych operuje skrypt. Argumenty skryptÃ³w pokrywajÄ… siÄ™ z tymi od funkcji:

- `$1`, `$2` to pozycyjne argumenty.
- `$0` zawiera nazwÄ™ skryptu.
- `$@` zwraca listÄ™ wszystkich argumentÃ³w.
- `$#` zwraca liczbÄ™ argumentÃ³w.

<Callout variant="info">

Aby poznaÄ‡ podstawy argumentÃ³w i opcji, sprawdÅº mÃ³j [poprzedni wpis](/pl/blog/jesus-christ-thats-bourne-again-shell/).

</Callout>

## Praca z opcjami Basha

**Opcje** takÅ¼e pozwalajÄ… nam przekazaÄ‡ informacje do skryptu przez CLI. NajczÄ™Å›ciej wykorzystujesz zarÃ³wno opcje jak i argumenty podczas programowania. Prosta komenda Git'a zawiera oba typy:

```bash
git commit -m "fix: Hyper-important bug"
# Opcja: -m
# Argument: "fix: Hyper-important bug"
```

Pod spodem, opcje sÄ… dostÄ™pne z wykorzystaniem sÅ‚owa kluczowego `getopts`. Jest ono wbudowane w Basha i przetwarza krÃ³tkie opcje (jak `-a`, `-v`, `-p`) z parametrÃ³w pozycyjnych skryptu.

```bash
while getopts :u:p:a option; do
	case $option in
		u) user=$OPTARG;;
		p) pass=$OPTARG;;
		# a jest bez argumentÃ³w, wiÄ™c moÅ¼esz sprawdziÄ‡ tylko obecnoÅ›Ä‡
		a) echo "got the 'a' flag";;
		?) echo "Unknown option" # Pierwszy dwukropek Å‚apie to
	esac
done

echo "user: $user / pass: $pass"
```

Opcje mogÄ… byÄ‡ okreÅ›lone i uÅ¼yte w dowolnej kolejnoÅ›ci. MogÄ… nawet same przyjmowaÄ‡ argumenty.

## Uzyskiwanie danych wejÅ›ciowych w skryptach Basha

PodsyÅ‚anie argumentÃ³w do skryptÃ³w w momencie ich wywoÅ‚ywania jest przydatne, ale czasami potrzebujemy takich danych, gdy skrypt jest uruchomiony. Na przykÅ‚ad, w momencie, gdy potrzebujesz wielokrotnie nastÄ™pujÄ…cych po sobie odpowiedzi od uÅ¼ytkownika. W Bashu, istniejÄ… zarezerwowane sÅ‚owa kluczowe do zbierania danych wejÅ›ciowych.

SÅ‚owo kluczowe `read` zatrzymuje dziaÅ‚anie skryptu do momentu podania danych.

```bash
echo "Jak masz na imiÄ™?"
read name

echo "Jakie jest twoje hasÅ‚o?"
read -s pass
```

Flaga `-s` oznacza "silent" - Bash nie wyÅ›wietli wpisywanych znakÃ³w. Inne popularne opcje to:

- `-r` - nie uÅ¼ywaj ukoÅ›nikÃ³w jako znakÃ³w ucieczki (polecana do surowych danych wejÅ›ciowych).
- `-p` - pokaÅ¼ prompt przed odczytaniem.
- `-e` - uÅ¼yj edycji linii (interaktywne).
- `-n` - odczytaj co najwyÅ¼ej N znakÃ³w.

Aby zawÄ™ziÄ‡ dane wejÅ›ciowe do kilku opcji, moÅ¼esz skorzystaÄ‡ ze sÅ‚owa kluczowego `select`. MoÅ¼esz poÅ‚Ä…czyÄ‡ je ze skÅ‚adniÄ… "case", aby pozwoliÄ‡ uÅ¼ytkownikowi wybieraÄ‡ z wczeÅ›niej zdefiniowanej listy opcji.

```bash
select actor in "sam" "clifford" "fragile"
do
	case $actor in
		sam) echo "Norman Reedus";;
		clifford) echo "Mads Mikkelsen";;
		fragile) echo "LÃ©a Seydoux";;
		quit) break;;
		*) echo "Prawdopodobnie nie ma w obsadzie."
	esac
done
```

W naszym prostym przykÅ‚adzie, opcje oddzielone sÄ… Å›rednikami. KaÅ¼da z nich wyÅ›wietla prosty Å‚aÅ„cuch znakÃ³w. Jest to czytelne, ale jeÅ¼eli masz wiele komend do uruchomienia, lepszym wyborem bÄ™dÄ… funkcje.

### Zagwarantowanie odpowiedzi

Nasz skrypt dziaÅ‚a, ale naciÅ›niÄ™cie <Kbd>Enter</Kbd> pomija odpowiedÅº i posyÅ‚a puste pole. Czasami nie jest to poÅ¼Ä…dane zachowanie. Istnieje wiele sposobÃ³w na zagwarantowanie odpowiedzi w Bashu.

Na przykÅ‚ad, moÅ¼esz zasugerowaÄ‡ opcjÄ™, wykorzystujÄ…c flagÄ™ `-i`.

```bash
read -ep "Ulubiona gra? " -i "MGS 3" favgame
echo "$favgame"
```

Lub sprawdziÄ‡ liczbÄ™ argumentÃ³w.

```bash
if (($#<3)); then
	echo "Ta komenda wymaga trzech argumentÃ³w"
	echo "uÅ¼ytkownik, id i ulubiony numer"
else
	echo "uÅ¼ytkownik: $1"
	echo "id: $2"
	echo "ulubiony number: $3"
fi
```

---

Nie mogÄ™ zagwarantowaÄ‡ odpowiedzi od ciebie, ale moÅ¼esz daÄ‡ mi znaÄ‡ czy spodobaÅ‚ ci siÄ™ ten post. PowinieneÅ› teraz byÄ‡ w stanie odczytywaÄ‡ i pisaÄ‡ proste skrypty w Bashu. ByÄ‡ moÅ¼e napiszemy jakiÅ› prosty skrypt w przyszÅ‚ych postach. Skrypty Basha w sieci nie powinny byÄ‡ juÅ¼ takie straszne. No i najwaÅ¼niejsze - powinieneÅ› byÄ‡ w stanie rozpoznaÄ‡, gdy agent Cursora postanowi halucynowaÄ‡ jakÄ…Å› dziwnÄ… skÅ‚adniÄ™ Basha.
